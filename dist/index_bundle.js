(()=>{"use strict";const e="goBack",t="redirect",s="SignIn-submit",n="SignUp-submit",a="ProfileEdit-submit",i="ProfileView-needUserData",r="mainPageView-needData",o="mainPageController-needGetFolderList",l="mainPageController-needGetLetterList",u="mainPageController-needGetLetter",p="sendLetterView-sendLetter",c={success:"letterModelEvents-getLetter-success",fail:"letterModelEvents-getLetter-fail"},m={success:"letterModelEvents-getLetterList-success",fail:"letterModelEvents-getLetterList-fail"},g={success:"letterModelEvents-getFolderList-success",fail:"letterModelEvents-getFolderList-fail"},d={success:"letterModelEvents-sendLetter-success",fail:"letterModelEvents-sendLetter-fail"},h={success:"UserModel-authorizationSuccess",fail:"UserModel-authorizationFail"},f={success:"UserModel-signupSuccess",fail:"UserModel-signupFail"},w={success:"UserModel-profileEditSuccess",fail:"UserModel-profileEditFail"},T={success:"profile-successGetData",fail:"fail-getData"},b="/signin",P="/signup",v="/profile",C="/profileEdit",B="/letters",V="/sendLetter";let y=new class{on(e,t){return this._eventHandlers||(this._eventHandlers={}),this._eventHandlers[e]||(this._eventHandlers[e]=[]),this._eventHandlers[e].push(t),this}off(e,t){let s=this._eventHandlers&&this._eventHandlers[e];s&&(s=s.filter((e=>e===t)),this._eventHandlers=s)}emit(e,...t){console.log("EMIT",e,t),this._eventHandlers&&this._eventHandlers[e]&&this._eventHandlers[e].forEach((e=>e.apply(this,t)))}};function x(e,t,s,n){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(n?e:e+'="'+e+'"');var a=typeof t;return"object"!==a&&"function"!==a||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),s||-1===t.indexOf('"'))?(s&&(t=E(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}function N(e,t){return Array.isArray(e)?function(e,t){for(var s,n="",a="",i=Array.isArray(t),r=0;r<e.length;r++)(s=N(e[r]))&&(i&&t[r]&&(s=E(s)),n=n+a+s,a=" ");return n}(e,t):e&&"object"==typeof e?function(e){var t="",s="";for(var n in e)n&&e[n]&&S.call(e,n)&&(t=t+s+n,s=" ");return t}(e):e||""}function E(e){var t=""+e,s=A.exec(t);if(!s)return e;var n,a,i,r="";for(n=s.index,a=0;n<t.length;n++){switch(t.charCodeAt(n)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;default:continue}a!==n&&(r+=t.substring(a,n)),a=n+1,r+=i}return a!==n?r+t.substring(a,n):r}var S=Object.prototype.hasOwnProperty,A=/["&<>]/;function L(e,t,s,n){if(!(e instanceof Error))throw e;if(!("undefined"==typeof window&&t||n))throw e.message+=" on line "+s,e;try{n=n||Object(function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}()).readFileSync(t,"utf8")}catch(t){L(e,null,s)}var a=3,i=n.split("\n"),r=Math.max(s-a,0),o=Math.min(i.length,s+a);throw a=i.slice(r,o).map((function(e,t){var n=t+r+1;return(n==s?"  > ":"    ")+n+"| "+e})).join("\n"),e.path=t,e.message=(t||"Pug")+":"+s+"\n"+a+"\n\n"+e.message,e}function O(e){var t,s,n,a="",i={};try{var r={".//src/Views/PugTemplates/SignInForm.pug":"include  BaseComponents/button\ninclude BaseComponents/pageTitle\ninclude BaseComponents/Text\ninclude BaseComponents/avatar\ninclude BaseComponents/classNames\n\n+pageTitle('Войти')\nform(method='POST' class=classNames.formClass)\n    +text('Login')\n    input(type='text', name='email', class=classNames.inputClass)\n    +text('Password')\n    input(type='password', name='password', class=classNames.inputClass)\n    input(type='submit', value='Войти', class=classNames.inputClass)\n    +button('Регистрация','signup', classNames.loginButton)\n    +button('Назад','back', classNames.regButton)\n\n//export {signinformTemplate}","src/Views/PugTemplates/BaseComponents/button.pug":"mixin button(text, name, className)\n    button(class=className, name=name) #{text}","src/Views/PugTemplates/BaseComponents/pageTitle.pug":"mixin pageTitle(text, className)\n    h1(class=className) #{text}","src/Views/PugTemplates/BaseComponents/Text.pug":"mixin text(text, name)\n    p(class='MainTitle', name=name) #{text}","src/Views/PugTemplates/BaseComponents/avatar.pug":"mixin avatar(src)\n    img(width=70, height=70, id='avatar', src=src)","src/Views/PugTemplates/BaseComponents/classNames.pug":"- var classNames ={inputClass:'login-reg-input',formClass:'login-form',regButton:'reg-button',loginButton:'login-button', sendLetterButton:'send-button'}"};n=1,s="src/Views/PugTemplates/BaseComponents/button.pug",i.button=t=function(e,i,r){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+"<button"+(x("class",N([r],[!0]),!1,!1)+x("name",i,!0,!1))+">",n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+E(null==(t=e)?"":t)+"</button>"},n=1,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",i.pageTitle=t=function(e,i){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",a=a+"<h1"+x("class",N([i],[!0]),!1,!1)+">",n=2,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",a=a+E(null==(t=e)?"":t)+"</h1>"},n=1,s="src/Views/PugTemplates/BaseComponents/Text.pug",i.text=t=function(e,i){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/Text.pug",a=a+'<p class="MainTitle"'+x("name",i,!0,!1)+">",n=2,s="src/Views/PugTemplates/BaseComponents/Text.pug",a=a+E(null==(t=e)?"":t)+"</p>"},n=1,s="src/Views/PugTemplates/BaseComponents/avatar.pug",n=1,s="src/Views/PugTemplates/BaseComponents/classNames.pug";var o={inputClass:"login-reg-input",formClass:"login-form",regButton:"reg-button",loginButton:"login-button",sendLetterButton:"send-button"};n=7,s=".//src/Views/PugTemplates/SignInForm.pug",i.pageTitle("Войти"),n=8,s=".//src/Views/PugTemplates/SignInForm.pug",a=a+"<form"+x("class",N([o.formClass],[!0]),!1,!1)+' method="POST">',n=9,s=".//src/Views/PugTemplates/SignInForm.pug",i.text("Login"),n=10,s=".//src/Views/PugTemplates/SignInForm.pug",a=a+"<input"+x("class",N([o.inputClass],[!0]),!1,!1)+' type="text" name="email"/>',n=11,s=".//src/Views/PugTemplates/SignInForm.pug",i.text("Password"),n=12,s=".//src/Views/PugTemplates/SignInForm.pug",a=a+"<input"+x("class",N([o.inputClass],[!0]),!1,!1)+' type="password" name="password"/>',n=13,s=".//src/Views/PugTemplates/SignInForm.pug",a=a+"<input"+x("class",N([o.inputClass],[!0]),!1,!1)+' type="submit" value="Войти"/>',n=14,s=".//src/Views/PugTemplates/SignInForm.pug",i.button("Регистрация","signup",o.loginButton),n=15,s=".//src/Views/PugTemplates/SignInForm.pug",i.button("Назад","back",o.regButton),a+="</form>",n=17,s=".//src/Views/PugTemplates/SignInForm.pug",a+="\x3c!--export {signinformTemplate}--\x3e"}catch(e){L(e,s,n,r[s])}return a}function F(e,t,s,n){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(n?e:e+'="'+e+'"');var a=typeof t;return"object"!==a&&"function"!==a||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),s||-1===t.indexOf('"'))?(s&&(t=U(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}function k(e,t){return Array.isArray(e)?function(e,t){for(var s,n="",a="",i=Array.isArray(t),r=0;r<e.length;r++)(s=k(e[r]))&&(i&&t[r]&&(s=U(s)),n=n+a+s,a=" ");return n}(e,t):e&&"object"==typeof e?function(e){var t="",s="";for(var n in e)n&&e[n]&&I.call(e,n)&&(t=t+s+n,s=" ");return t}(e):e||""}function U(e){var t=""+e,s=D.exec(t);if(!s)return e;var n,a,i,r="";for(n=s.index,a=0;n<t.length;n++){switch(t.charCodeAt(n)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;default:continue}a!==n&&(r+=t.substring(a,n)),a=n+1,r+=i}return a!==n?r+t.substring(a,n):r}var I=Object.prototype.hasOwnProperty,D=/["&<>]/;function M(e,t,s,n){if(!(e instanceof Error))throw e;if(!("undefined"==typeof window&&t||n))throw e.message+=" on line "+s,e;try{n=n||Object(function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}()).readFileSync(t,"utf8")}catch(t){M(e,null,s)}var a=3,i=n.split("\n"),r=Math.max(s-a,0),o=Math.min(i.length,s+a);throw a=i.slice(r,o).map((function(e,t){var n=t+r+1;return(n==s?"  > ":"    ")+n+"| "+e})).join("\n"),e.path=t,e.message=(t||"Pug")+":"+s+"\n"+a+"\n\n"+e.message,e}function _(e){var t,s,n,a="",i={};try{var r={".//src/Views/PugTemplates/SignUpForm.pug":"include  BaseComponents/button\ninclude  BaseComponents/button\ninclude BaseComponents/pageTitle\ninclude BaseComponents/Text\ninclude BaseComponents/avatar\ninclude BaseComponents/classNames\n\n+pageTitle('Зарегистрироваться')\n\nform(method='POST', enctype = 'multipart/form-data', class='reg-form')\n    p(class='InputTitle') Имя\n    input(type='text', name='name', class=classNames.inputClass)\n    p(class='InputTitle') Фамилия\n    input(type='text', name='surname', class=classNames.inputClass)\n    p(class='InputTitle') Email\n    input(type='text', name='email', class=classNames.inputClass)\n    p(class='InputTitle') Введите Пароль\n    input(type='password', name='password1', class=classNames.inputClass)\n    p(class='InputTitle') Повторите пароль\n    input(type='password', name='password2', class=classNames.inputClass)\n    p(class='InputTitle') Аватар\n    input(type='file', placeholder='Выберете аватар', name='avatar', class=classNames.inputClass)\n    input(type='submit', value='Зарегистироваться', class='submit', class=classNames.inputClass)\n    +button('Назад', 'back', classNames.regButton)\n\n//export {template}","src/Views/PugTemplates/BaseComponents/button.pug":"mixin button(text, name, className)\n    button(class=className, name=name) #{text}","src/Views/PugTemplates/BaseComponents/pageTitle.pug":"mixin pageTitle(text, className)\n    h1(class=className) #{text}","src/Views/PugTemplates/BaseComponents/Text.pug":"mixin text(text, name)\n    p(class='MainTitle', name=name) #{text}","src/Views/PugTemplates/BaseComponents/avatar.pug":"mixin avatar(src)\n    img(width=70, height=70, id='avatar', src=src)","src/Views/PugTemplates/BaseComponents/classNames.pug":"- var classNames ={inputClass:'login-reg-input',formClass:'login-form',regButton:'reg-button',loginButton:'login-button', sendLetterButton:'send-button'}"};n=1,s="src/Views/PugTemplates/BaseComponents/button.pug",i.button=t=function(e,i,r){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+"<button"+(F("class",k([r],[!0]),!1,!1)+F("name",i,!0,!1))+">",n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+U(null==(t=e)?"":t)+"</button>"},n=1,s="src/Views/PugTemplates/BaseComponents/button.pug",i.button=t=function(e,i,r){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+"<button"+(F("class",k([r],[!0]),!1,!1)+F("name",i,!0,!1))+">",n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+U(null==(t=e)?"":t)+"</button>"},n=1,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",i.pageTitle=t=function(e,i){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",a=a+"<h1"+F("class",k([i],[!0]),!1,!1)+">",n=2,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",a=a+U(null==(t=e)?"":t)+"</h1>"},n=1,s="src/Views/PugTemplates/BaseComponents/Text.pug",n=1,s="src/Views/PugTemplates/BaseComponents/avatar.pug",n=1,s="src/Views/PugTemplates/BaseComponents/classNames.pug";var o={inputClass:"login-reg-input",formClass:"login-form",regButton:"reg-button",loginButton:"login-button",sendLetterButton:"send-button"};n=8,s=".//src/Views/PugTemplates/SignUpForm.pug",i.pageTitle("Зарегистрироваться"),n=10,s=".//src/Views/PugTemplates/SignUpForm.pug",a+='<form class="reg-form" method="POST" enctype="multipart/form-data">',n=11,s=".//src/Views/PugTemplates/SignUpForm.pug",a+='<p class="InputTitle">',n=11,s=".//src/Views/PugTemplates/SignUpForm.pug",n=12,s=".//src/Views/PugTemplates/SignUpForm.pug",a=(a+="Имя</p>")+"<input"+F("class",k([o.inputClass],[!0]),!1,!1)+' type="text" name="name"/>',n=13,s=".//src/Views/PugTemplates/SignUpForm.pug",a+='<p class="InputTitle">',n=13,s=".//src/Views/PugTemplates/SignUpForm.pug",n=14,s=".//src/Views/PugTemplates/SignUpForm.pug",a=(a+="Фамилия</p>")+"<input"+F("class",k([o.inputClass],[!0]),!1,!1)+' type="text" name="surname"/>',n=15,s=".//src/Views/PugTemplates/SignUpForm.pug",a+='<p class="InputTitle">',n=15,s=".//src/Views/PugTemplates/SignUpForm.pug",n=16,s=".//src/Views/PugTemplates/SignUpForm.pug",a=(a+="Email</p>")+"<input"+F("class",k([o.inputClass],[!0]),!1,!1)+' type="text" name="email"/>',n=17,s=".//src/Views/PugTemplates/SignUpForm.pug",a+='<p class="InputTitle">',n=17,s=".//src/Views/PugTemplates/SignUpForm.pug",n=18,s=".//src/Views/PugTemplates/SignUpForm.pug",a=(a+="Введите Пароль</p>")+"<input"+F("class",k([o.inputClass],[!0]),!1,!1)+' type="password" name="password1"/>',n=19,s=".//src/Views/PugTemplates/SignUpForm.pug",a+='<p class="InputTitle">',n=19,s=".//src/Views/PugTemplates/SignUpForm.pug",n=20,s=".//src/Views/PugTemplates/SignUpForm.pug",a=(a+="Повторите пароль</p>")+"<input"+F("class",k([o.inputClass],[!0]),!1,!1)+' type="password" name="password2"/>',n=21,s=".//src/Views/PugTemplates/SignUpForm.pug",a+='<p class="InputTitle">',n=21,s=".//src/Views/PugTemplates/SignUpForm.pug",n=22,s=".//src/Views/PugTemplates/SignUpForm.pug",a=(a+="Аватар</p>")+"<input"+F("class",k([o.inputClass],[!0]),!1,!1)+' type="file" placeholder="Выберете аватар" name="avatar"/>',n=23,s=".//src/Views/PugTemplates/SignUpForm.pug",a=a+"<input"+F("class",k(["submit",o.inputClass],[!1,!0]),!1,!1)+' type="submit" value="Зарегистироваться"/>',n=24,s=".//src/Views/PugTemplates/SignUpForm.pug",i.button("Назад","back",o.regButton),a+="</form>",n=26,s=".//src/Views/PugTemplates/SignUpForm.pug",a+="\x3c!--export {template}--\x3e"}catch(e){M(e,s,n,r[s])}return a}const R=new class{_checkEmail(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}_checkName(e){return/[0-9a-z]+/i.test(e)}_checkSurname(e){return/[0-9a-z]+/i.test(e)}_checkPassword(e){return e.length>3}_checkPasswordEqual(e,t){return e===t}checkSignInForm(e){const t={};return this._checkEmail(e.get("email"))||(t.email="Некорректный email"),this._checkPassword(e.get("password"))||(t.password="слишком короткий пароль"),t}checkSignUpForm(e){console.log("VALIDATOR SIGN UP",e.get("email"),e.get("password1"),e.get("password2"),e.get("name"),e.get("surname"));const t={};return this._checkEmail(e.get("email"))||(t.email="Некорректный email"),this._checkPassword(e.get("password1"))?this._checkPasswordEqual(e.get("password1"),e.get("password2"))||(t.password2="Пароли не совпадают"):t.password1="слишком короткий пароль",this._checkName(e.get("name"))||(t.name="Некорректное имя"),this._checkSurname(e.get("surname"))||(t.surname="Некорректная фамилия"),t}};function j(e,t,s,n){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(n?e:e+'="'+e+'"');var a=typeof t;return"object"!==a&&"function"!==a||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),s||-1===t.indexOf('"'))?(s&&(t=G(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}function H(e,t){return Array.isArray(e)?function(e,t){for(var s,n="",a="",i=Array.isArray(t),r=0;r<e.length;r++)(s=H(e[r]))&&(i&&t[r]&&(s=G(s)),n=n+a+s,a=" ");return n}(e,t):e&&"object"==typeof e?function(e){var t="",s="";for(var n in e)n&&e[n]&&J.call(e,n)&&(t=t+s+n,s=" ");return t}(e):e||""}function G(e){var t=""+e,s=q.exec(t);if(!s)return e;var n,a,i,r="";for(n=s.index,a=0;n<t.length;n++){switch(t.charCodeAt(n)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;default:continue}a!==n&&(r+=t.substring(a,n)),a=n+1,r+=i}return a!==n?r+t.substring(a,n):r}var J=Object.prototype.hasOwnProperty,q=/["&<>]/;function W(e,t,s,n){if(!(e instanceof Error))throw e;if(!("undefined"==typeof window&&t||n))throw e.message+=" on line "+s,e;try{n=n||Object(function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}()).readFileSync(t,"utf8")}catch(t){W(e,null,s)}var a=3,i=n.split("\n"),r=Math.max(s-a,0),o=Math.min(i.length,s+a);throw a=i.slice(r,o).map((function(e,t){var n=t+r+1;return(n==s?"  > ":"    ")+n+"| "+e})).join("\n"),e.path=t,e.message=(t||"Pug")+":"+s+"\n"+a+"\n\n"+e.message,e}function z(e){var t,s,n,a="",i={};try{var r={".//src/Views/PugTemplates/ProfilePage.pug":"include  BaseComponents/button\ninclude BaseComponents/pageTitle\ninclude BaseComponents/Text\ninclude BaseComponents/avatar\ninclude BaseComponents/classNames\n\n+pageTitle('Профиль')\n\ndiv\n    +text(locals.name + ' ' + locals.surname, 'profile_name')\n    +text('Email: ' + locals.email)\n    +text('Аватар')\n    +avatar(locals.avatar)\n    +button('Редактировать', 'editButton')\n    +button('Назад' ,name='back')\n\n\n//export {template}","src/Views/PugTemplates/BaseComponents/button.pug":"mixin button(text, name, className)\n    button(class=className, name=name) #{text}","src/Views/PugTemplates/BaseComponents/pageTitle.pug":"mixin pageTitle(text, className)\n    h1(class=className) #{text}","src/Views/PugTemplates/BaseComponents/Text.pug":"mixin text(text, name)\n    p(class='MainTitle', name=name) #{text}","src/Views/PugTemplates/BaseComponents/avatar.pug":"mixin avatar(src)\n    img(width=70, height=70, id='avatar', src=src)","src/Views/PugTemplates/BaseComponents/classNames.pug":"- var classNames ={inputClass:'login-reg-input',formClass:'login-form',regButton:'reg-button',loginButton:'login-button', sendLetterButton:'send-button'}"},o=e||{};(function(r){n=1,s="src/Views/PugTemplates/BaseComponents/button.pug",i.button=t=function(e,i,r){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+"<button"+(j("class",H([r],[!0]),!1,!1)+j("name",i,!0,!1))+">",n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+G(null==(t=e)?"":t)+"</button>"},n=1,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",i.pageTitle=t=function(e,i){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",a=a+"<h1"+j("class",H([i],[!0]),!1,!1)+">",n=2,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",a=a+G(null==(t=e)?"":t)+"</h1>"},n=1,s="src/Views/PugTemplates/BaseComponents/Text.pug",i.text=t=function(e,i){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/Text.pug",a=a+'<p class="MainTitle"'+j("name",i,!0,!1)+">",n=2,s="src/Views/PugTemplates/BaseComponents/Text.pug",a=a+G(null==(t=e)?"":t)+"</p>"},n=1,s="src/Views/PugTemplates/BaseComponents/avatar.pug",i.avatar=t=function(e){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/avatar.pug",a=a+'<img width="70" height="70" id="avatar"'+j("src",e,!0,!1)+"/>"},n=1,s="src/Views/PugTemplates/BaseComponents/classNames.pug",n=7,s=".//src/Views/PugTemplates/ProfilePage.pug",i.pageTitle("Профиль"),n=9,s=".//src/Views/PugTemplates/ProfilePage.pug",a+="<div>",n=10,s=".//src/Views/PugTemplates/ProfilePage.pug",i.text(e.name+" "+e.surname,"profile_name"),n=11,s=".//src/Views/PugTemplates/ProfilePage.pug",i.text("Email: "+e.email),n=12,s=".//src/Views/PugTemplates/ProfilePage.pug",i.text("Аватар"),n=13,s=".//src/Views/PugTemplates/ProfilePage.pug",i.avatar(e.avatar),n=14,s=".//src/Views/PugTemplates/ProfilePage.pug",i.button("Редактировать","editButton"),n=15,s=".//src/Views/PugTemplates/ProfilePage.pug",i.button("Назад","back"),a+="</div>",n=18,s=".//src/Views/PugTemplates/ProfilePage.pug",a+="\x3c!--export {template}--\x3e"}).call(this,"name"in o?o.name:"undefined"!=typeof name?name:void 0)}catch(e){W(e,s,n,r[s])}return a}Object.prototype.hasOwnProperty;var K=/["&<>]/;function Y(e,t,s,n){if(!(e instanceof Error))throw e;if(!("undefined"==typeof window&&t||n))throw e.message+=" on line "+s,e;try{n=n||Object(function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}()).readFileSync(t,"utf8")}catch(t){Y(e,null,s)}var a=3,i=n.split("\n"),r=Math.max(s-a,0),o=Math.min(i.length,s+a);throw a=i.slice(r,o).map((function(e,t){var n=t+r+1;return(n==s?"  > ":"    ")+n+"| "+e})).join("\n"),e.path=t,e.message=(t||"Pug")+":"+s+"\n"+a+"\n\n"+e.message,e}function Z(e){var t,s,n="",a={};try{var i={".//src/Views/PugTemplates/BaseComponents/navbar.pug":"include button\ninclude avatar\nmixin navbar(src)\n    ul()\n        li() LOGO\n        li()\n            a(name = 'navbar-send') 'Отправить'\n        li()\n            +avatar('')\n        li()\n            a(name = 'navbar-profile') 'Профиль'\n        li()\n            a(name = 'navbar-exit') 'Выйти'\n\n+navbar(src)\n//export {template}","src/Views/PugTemplates/BaseComponents/button.pug":"mixin button(text, name, className)\n    button(class=className, name=name) #{text}","src/Views/PugTemplates/BaseComponents/avatar.pug":"mixin avatar(src)\n    img(width=70, height=70, id='avatar', src=src)"},r=e||{};(function(e){s=1,t="src/Views/PugTemplates/BaseComponents/button.pug",s=1,t="src/Views/PugTemplates/BaseComponents/avatar.pug",a.avatar=function(e){this&&this.block,this&&this.attributes,s=2,t="src/Views/PugTemplates/BaseComponents/avatar.pug",n=n+'<img width="70" height="70" id="avatar"'+function(e,t,s,n){if(!1===t||null==t)return"";if(!0===t)return' src="src"';var a=typeof t;return"object"!==a&&"function"!==a||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),true)?' src="'+(t=function(e){var t=""+e,s=K.exec(t);if(!s)return e;var n,a,i,r="";for(n=s.index,a=0;n<t.length;n++){switch(t.charCodeAt(n)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;default:continue}a!==n&&(r+=t.substring(a,n)),a=n+1,r+=i}return a!==n?r+t.substring(a,n):r}(t))+'"':" src='"+t.replace(/'/g,"&#39;")+"'"}(0,e)+"/>"},s=3,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",a.navbar=function(e){this&&this.block,this&&this.attributes,s=4,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+="<ul>",s=5,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+="<li>",s=5,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+="LOGO</li>",s=6,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+="<li>",s=7,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+='<a name="navbar-send">',s=7,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+="'Отправить'</a></li>",s=8,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+="<li>",s=9,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",a.avatar(""),n+="</li>",s=10,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+="<li>",s=11,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+='<a name="navbar-profile">',s=11,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+="'Профиль'</a></li>",s=12,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+="<li>",s=13,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+='<a name="navbar-exit">',s=13,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+="'Выйти'</a></li></ul>"},s=15,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",a.navbar(e),s=16,t=".//src/Views/PugTemplates/BaseComponents/navbar.pug",n+="\x3c!--export {template}--\x3e"}).call(this,"src"in r?r.src:"undefined"!=typeof src?src:void 0)}catch(e){Y(e,t,s,i[t])}return n}const $=new class{constructor(){this.element=document.body}render(e){console.log("NAVBAR VIEW RENDER",e);let s=document.getElementById("navbar")||document.createElement("div");s.id="navbar",s.innerHTML=Z(e),this.element.appendChild(s);let n=document.getElementsByName("navbar-send")[0],a=document.getElementsByName("navbar-profile")[0],i=document.getElementsByName("navbar-exit")[0];n.onclick=e=>{console.log("CLICK"),e.preventDefault(),y.emit(t,{path:V})},a.onclick=e=>{e.preventDefault(),console.log("CLICK"),y.emit(t,{path:v})},i.onclick=e=>{console.log("CLICK"),e.preventDefault(),y.emit(t,{path:"/logout"})},i.onsubmit=e=>{console.log("submint"),e.preventDefault()}}hide(){document.getElementById("navbar").innerHTML=""}};function Q(e,t,s,n){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(n?e:e+'="'+e+'"');var a=typeof t;return"object"!==a&&"function"!==a||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),s||-1===t.indexOf('"'))?(s&&(t=ee(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}function X(e,t){return Array.isArray(e)?function(e,t){for(var s,n="",a="",i=Array.isArray(t),r=0;r<e.length;r++)(s=X(e[r]))&&(i&&t[r]&&(s=ee(s)),n=n+a+s,a=" ");return n}(e,t):e&&"object"==typeof e?function(e){var t="",s="";for(var n in e)n&&e[n]&&te.call(e,n)&&(t=t+s+n,s=" ");return t}(e):e||""}function ee(e){var t=""+e,s=se.exec(t);if(!s)return e;var n,a,i,r="";for(n=s.index,a=0;n<t.length;n++){switch(t.charCodeAt(n)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;default:continue}a!==n&&(r+=t.substring(a,n)),a=n+1,r+=i}return a!==n?r+t.substring(a,n):r}var te=Object.prototype.hasOwnProperty,se=/["&<>]/;function ne(e,t,s,n){if(!(e instanceof Error))throw e;if(!("undefined"==typeof window&&t||n))throw e.message+=" on line "+s,e;try{n=n||Object(function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}()).readFileSync(t,"utf8")}catch(t){ne(e,null,s)}var a=3,i=n.split("\n"),r=Math.max(s-a,0),o=Math.min(i.length,s+a);throw a=i.slice(r,o).map((function(e,t){var n=t+r+1;return(n==s?"  > ":"    ")+n+"| "+e})).join("\n"),e.path=t,e.message=(t||"Pug")+":"+s+"\n"+a+"\n\n"+e.message,e}function ae(e){var t,s,n,a="",i={};try{var r={".//src/Views/PugTemplates/ProfileEditForm.pug":"include  BaseComponents/button\ninclude BaseComponents/pageTitle\ninclude BaseComponents/Text\ninclude BaseComponents/avatar\ninclude BaseComponents/classNames\n\n+pageTitle('Редактирование профиля')\n\nform(method='POST', enctype = 'multipart/form-data')\n    +text('Имя')\n    input(type='text', name='profile_firstName', value=locals.name, class=classNames.inputClass)\n    +text('Фамилия')\n    input(type='text', name='profile_lastName', value=locals.surname, class=classNames.inputClass)\n    +text('Аватар')\n    +avatar(locals.avatar)\n    input(type='file', placeholder='Выберете аватар', name='avatar', class=classNames.inputClass)\n    input(type='submit', value='Применить', class=classNames.inputClass)\n    +button('Назад','back')\n\n//export {template}","src/Views/PugTemplates/BaseComponents/button.pug":"mixin button(text, name, className)\n    button(class=className, name=name) #{text}","src/Views/PugTemplates/BaseComponents/pageTitle.pug":"mixin pageTitle(text, className)\n    h1(class=className) #{text}","src/Views/PugTemplates/BaseComponents/Text.pug":"mixin text(text, name)\n    p(class='MainTitle', name=name) #{text}","src/Views/PugTemplates/BaseComponents/avatar.pug":"mixin avatar(src)\n    img(width=70, height=70, id='avatar', src=src)","src/Views/PugTemplates/BaseComponents/classNames.pug":"- var classNames ={inputClass:'login-reg-input',formClass:'login-form',regButton:'reg-button',loginButton:'login-button', sendLetterButton:'send-button'}"};n=1,s="src/Views/PugTemplates/BaseComponents/button.pug",i.button=t=function(e,i,r){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+"<button"+(Q("class",X([r],[!0]),!1,!1)+Q("name",i,!0,!1))+">",n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+ee(null==(t=e)?"":t)+"</button>"},n=1,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",i.pageTitle=t=function(e,i){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",a=a+"<h1"+Q("class",X([i],[!0]),!1,!1)+">",n=2,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",a=a+ee(null==(t=e)?"":t)+"</h1>"},n=1,s="src/Views/PugTemplates/BaseComponents/Text.pug",i.text=t=function(e,i){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/Text.pug",a=a+'<p class="MainTitle"'+Q("name",i,!0,!1)+">",n=2,s="src/Views/PugTemplates/BaseComponents/Text.pug",a=a+ee(null==(t=e)?"":t)+"</p>"},n=1,s="src/Views/PugTemplates/BaseComponents/avatar.pug",i.avatar=t=function(e){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/avatar.pug",a=a+'<img width="70" height="70" id="avatar"'+Q("src",e,!0,!1)+"/>"},n=1,s="src/Views/PugTemplates/BaseComponents/classNames.pug";var o={inputClass:"login-reg-input",formClass:"login-form",regButton:"reg-button",loginButton:"login-button",sendLetterButton:"send-button"};n=7,s=".//src/Views/PugTemplates/ProfileEditForm.pug",i.pageTitle("Редактирование профиля"),n=9,s=".//src/Views/PugTemplates/ProfileEditForm.pug",a+='<form method="POST" enctype="multipart/form-data">',n=10,s=".//src/Views/PugTemplates/ProfileEditForm.pug",i.text("Имя"),n=11,s=".//src/Views/PugTemplates/ProfileEditForm.pug",a=a+"<input"+Q("class",X([o.inputClass],[!0]),!1,!1)+' type="text" name="profile_firstName"'+Q("value",e.name,!0,!1)+"/>",n=12,s=".//src/Views/PugTemplates/ProfileEditForm.pug",i.text("Фамилия"),n=13,s=".//src/Views/PugTemplates/ProfileEditForm.pug",a=a+"<input"+Q("class",X([o.inputClass],[!0]),!1,!1)+' type="text" name="profile_lastName"'+Q("value",e.surname,!0,!1)+"/>",n=14,s=".//src/Views/PugTemplates/ProfileEditForm.pug",i.text("Аватар"),n=15,s=".//src/Views/PugTemplates/ProfileEditForm.pug",i.avatar(e.avatar),n=16,s=".//src/Views/PugTemplates/ProfileEditForm.pug",a=a+"<input"+Q("class",X([o.inputClass],[!0]),!1,!1)+' type="file" placeholder="Выберете аватар" name="avatar"/>',n=17,s=".//src/Views/PugTemplates/ProfileEditForm.pug",a=a+"<input"+Q("class",X([o.inputClass],[!0]),!1,!1)+' type="submit" value="Применить"/>',n=18,s=".//src/Views/PugTemplates/ProfileEditForm.pug",i.button("Назад","back"),a+="</form>",n=20,s=".//src/Views/PugTemplates/ProfileEditForm.pug",a+="\x3c!--export {template}--\x3e"}catch(e){ne(e,s,n,r[s])}return a}function ie(e,t,s,n){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(n?e:e+'="'+e+'"');var a=typeof t;return"object"!==a&&"function"!==a||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),s||-1===t.indexOf('"'))?(s&&(t=oe(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}function re(e,t){return Array.isArray(e)?function(e,t){for(var s,n="",a="",i=Array.isArray(t),r=0;r<e.length;r++)(s=re(e[r]))&&(i&&t[r]&&(s=oe(s)),n=n+a+s,a=" ");return n}(e,t):e&&"object"==typeof e?function(e){var t="",s="";for(var n in e)n&&e[n]&&le.call(e,n)&&(t=t+s+n,s=" ");return t}(e):e||""}function oe(e){var t=""+e,s=ue.exec(t);if(!s)return e;var n,a,i,r="";for(n=s.index,a=0;n<t.length;n++){switch(t.charCodeAt(n)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;default:continue}a!==n&&(r+=t.substring(a,n)),a=n+1,r+=i}return a!==n?r+t.substring(a,n):r}Object.prototype.hasOwnProperty;var le=Object.prototype.hasOwnProperty,ue=/["&<>]/;function pe(e,t,s,n){if(!(e instanceof Error))throw e;if(!("undefined"==typeof window&&t||n))throw e.message+=" on line "+s,e;try{n=n||Object(function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}()).readFileSync(t,"utf8")}catch(t){pe(e,null,s)}var a=3,i=n.split("\n"),r=Math.max(s-a,0),o=Math.min(i.length,s+a);throw a=i.slice(r,o).map((function(e,t){var n=t+r+1;return(n==s?"  > ":"    ")+n+"| "+e})).join("\n"),e.path=t,e.message=(t||"Pug")+":"+s+"\n"+a+"\n\n"+e.message,e}function ce(e){var t,s,n,a="",i={};try{var r={".//src/Views/PugTemplates/SendLetterForm.pug":"include BaseComponents/classNames\ninclude BaseComponents/pageTitle\ninclude  BaseComponents/button\n\n+pageTitle('Отправить письмо')\n\nform(method='POST', name='sendLetterForm' class=classNames.formClass)\n    p(class='InputTitle') Получатель\n    input(type='text', name='to', class=classNames.inputClass)\n    p(class='InputTitle') Тема\n    input(type='text', name='theme', class=classNames.inputClass)\n    p(class='InputTitle') Текст\n    input(type='text', name='text', class=classNames.inputClass)\n    input(type='submit', value='Отправить письмо', class='submit', class=classNames.inputClass)\n    +button('Назад', 'back', classNames.regButton)\n\n//export { template };","src/Views/PugTemplates/BaseComponents/classNames.pug":"- var classNames ={inputClass:'login-reg-input',formClass:'login-form',regButton:'reg-button',loginButton:'login-button', sendLetterButton:'send-button'}","src/Views/PugTemplates/BaseComponents/pageTitle.pug":"mixin pageTitle(text, className)\n    h1(class=className) #{text}","src/Views/PugTemplates/BaseComponents/button.pug":"mixin button(text, name, className)\n    button(class=className, name=name) #{text}"};n=1,s="src/Views/PugTemplates/BaseComponents/classNames.pug";var o={inputClass:"login-reg-input",formClass:"login-form",regButton:"reg-button",loginButton:"login-button",sendLetterButton:"send-button"};n=1,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",i.pageTitle=t=function(e,i){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",a=a+"<h1"+ie("class",re([i],[!0]),!1,!1)+">",n=2,s="src/Views/PugTemplates/BaseComponents/pageTitle.pug",a=a+oe(null==(t=e)?"":t)+"</h1>"},n=1,s="src/Views/PugTemplates/BaseComponents/button.pug",i.button=t=function(e,i,r){this&&this.block,this&&this.attributes,n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+"<button"+(ie("class",re([r],[!0]),!1,!1)+ie("name",i,!0,!1))+">",n=2,s="src/Views/PugTemplates/BaseComponents/button.pug",a=a+oe(null==(t=e)?"":t)+"</button>"},n=5,s=".//src/Views/PugTemplates/SendLetterForm.pug",i.pageTitle("Отправить письмо"),n=7,s=".//src/Views/PugTemplates/SendLetterForm.pug",a=a+"<form"+ie("class",re([o.formClass],[!0]),!1,!1)+' method="POST" name="sendLetterForm">',n=8,s=".//src/Views/PugTemplates/SendLetterForm.pug",a+='<p class="InputTitle">',n=8,s=".//src/Views/PugTemplates/SendLetterForm.pug",n=9,s=".//src/Views/PugTemplates/SendLetterForm.pug",a=(a+="Получатель</p>")+"<input"+ie("class",re([o.inputClass],[!0]),!1,!1)+' type="text" name="to"/>',n=10,s=".//src/Views/PugTemplates/SendLetterForm.pug",a+='<p class="InputTitle">',n=10,s=".//src/Views/PugTemplates/SendLetterForm.pug",n=11,s=".//src/Views/PugTemplates/SendLetterForm.pug",a=(a+="Тема</p>")+"<input"+ie("class",re([o.inputClass],[!0]),!1,!1)+' type="text" name="theme"/>',n=12,s=".//src/Views/PugTemplates/SendLetterForm.pug",a+='<p class="InputTitle">',n=12,s=".//src/Views/PugTemplates/SendLetterForm.pug",n=13,s=".//src/Views/PugTemplates/SendLetterForm.pug",a=(a+="Текст</p>")+"<input"+ie("class",re([o.inputClass],[!0]),!1,!1)+' type="text" name="text"/>',n=14,s=".//src/Views/PugTemplates/SendLetterForm.pug",a=a+"<input"+ie("class",re(["submit",o.inputClass],[!1,!0]),!1,!1)+' type="submit" value="Отправить письмо"/>',n=15,s=".//src/Views/PugTemplates/SendLetterForm.pug",i.button("Назад","back",o.regButton),a+="</form>",n=17,s=".//src/Views/PugTemplates/SendLetterForm.pug",a+="\x3c!--export { template };--\x3e"}catch(e){pe(e,s,n,r[s])}return a}let me=new class{constructor(){this.registeredPathes={},window.onpopstate=e=>{e.preventDefault(),console.log("HISTORY EVENT",e);try{this.registeredPathes[e.state.path].render(e.state.data)}catch(e){location=location.href}},y.on(t,this.go.bind(this)),y.on(e,this.back.bind(this))}register(e,t){this.registeredPathes[e]=t}start(e,t){window.history.pushState({path:e,data:t||1},"Start",e),this.registeredPathes[e].render(t)}go(e){console.log("GOOO",e),e&&(this.registeredPathes[e.path].render(e.data||0),window.history.pushState({path:e.path,data:e.data||0},e.path,e.path))}back(){console.log("I'L BE BACK"),window.history.back(),console.log("href",location.pathname),this.registeredPathes[location.pathname].render()}},ge=new class{constructor(e){this.element=e,y.on(h.fail,this.showErrors.bind(this))}render(){this.element.innerHTML=O();let n=document.getElementsByTagName("form")[0],a=document.getElementsByName("signup")[0],i=document.getElementsByName("back")[0];n.addEventListener("submit",(e=>{e.preventDefault();let t=new FormData(n);y.emit(s,{target:"SignInView",data:t})})),i.addEventListener("click",(t=>{t.preventDefault(),y.emit(e)})),a.addEventListener("click",(e=>{e.preventDefault(),y.emit(t,{path:P})}))}showErrors(e){console.log("SIGN IN ERRORS SHOW",e.errors);let t=document.getElementsByName("password")[0],s=document.getElementsByName("email")[0];console.log(e.password),e.password&&(t.value="",t.placeholder=e.password),e.email&&(s.value="",s.placeholder=e.email)}}(document.body),de=new class{constructor(e){this.element=e,y.on(f.fail,this.showErrors.bind(this))}render(){this.element.innerHTML=_();let t=document.getElementsByTagName("form")[0],s=document.getElementsByName("back")[0];t.addEventListener("submit",(e=>{e.preventDefault(),y.emit(n,{target:"SignUpView",data:new FormData(t)})})),s.addEventListener("click",(t=>{t.preventDefault(),y.emit(e)}))}showErrors(e){console.log("SIGN UP ERRORS SHOW",e);let t=document.getElementsByName("email")[0],s=document.getElementsByName("password1")[0],n=document.getElementsByName("password2")[0],a=document.getElementsByName("name")[0],i=document.getElementsByName("surname")[0];console.log(e.password1),e.password1?(s.value="",s.placeholder=e.password1):e.password2&&(n.value="",n.placeholder=e.password2),e.email&&(t.value="",t.placeholder=e.email),e.name&&(a.value="",a.placeholder=e.name),e.surname&&(i.value="",i.placeholder=e.surname)}}(document.body),he=new class{constructor(e){this.element=e,y.on(T.success,this.render.bind(this)),y.on(T.fail,this.showErrors.bind(this))}render(s){if(!s)return void y.emit(i);this.element.innerHTM="",$.render(s.navbar),this.element.innerHTML+=z(s);let n=document.getElementsByName("editButton")[0],a=document.getElementsByName("back")[0];n.addEventListener("click",(e=>{e.preventDefault(),y.emit(t,{path:C,data:s})})),a.addEventListener("click",(t=>{t.preventDefault(),y.emit(e)}))}showErrors(e){console.log("SHow Errors",e)}}(document.body),fe=new class{constructor(e){this.element=e,y.on(w.fail,this.showErrors.bind(this))}render(t){this.element.innerHTML="",$.render(t.navbar),this.element.innerHTML+=ae(t);let s=document.getElementsByTagName("form")[0],n=document.getElementsByName("back")[0];s.addEventListener("submit",(e=>{e.preventDefault(),y.emit(a,{target:"ProfileEditView",data:new FormData(s)})})),n.addEventListener("click",(t=>{t.preventDefault(),y.emit(e)}))}showErrors(e){console.log("PROFILE EDIT Errors",e)}}(document.body),we=new class{constructor(e){this.element=e}render(e){console.log("RENDER MAIN PAGE DATA, dat",e),e&&e.letterList&&e.folderList&&e.letter?(this.element.innerHTML="",$.render(e.navbar),this.element.appendChild(document.createTextNode("SUUUUUKA"))):y.emit(r)}}(document.body),Te=new class{constructor(e){this.element=e}render(e){e=e||{},console.log("SEND LETTER VIEW RENDER"),this.element.innerHTML="",$.render(e.navbar),this.element.innerHTML+=ce();let t=document.getElementsByName("sendLetterForm")[0];t.addEventListener("submit",(e=>{e.preventDefault(),y.emit(p,{data:new FormData(t)})}))}}(document.body),be=new class{constructor(e){this.baseUrl=e,this.user={},y.on(s,this.signIn.bind(this)),y.on(n,this.signUp.bind(this)),y.on(a,this.editUser.bind(this)),y.on(i,this.getUserData.bind(this,T))}signIn(e){let t=R.checkSignInForm(e.data);if(0!==Object.keys(t).length)return console.log("ERRORS IN SIGN IN ",t),void y.emit(h.fail,t);console.log("SIGN IN ",e,this.baseUrl+b),fetch(this.baseUrl+b,{method:"POST",mode:"cors",credentials:"include",body:e.data}).then((e=>e.json())).then((e=>{200===e.Code?this.getUserData(h):401===e.Code?y.emit(h.fail,{password:e.Description}):404===e.Code?y.emit(h.fail,{email:e.Description}):y.emit(h.fail,{unknowError:e.Description})})).catch((e=>{console.log("CAAAAAAAAAAAAAAAATCH",e)}))}signUp(e){let t=R.checkSignUpForm(e.data);if(0!==Object.keys(t).length)return console.log("ERRORS IN SIGN UP ",t),void y.emit(f.fail,t);fetch(this.baseUrl+P,{method:"POST",mode:"cors",credentials:"include",body:e.data}).then((e=>e.json())).then((e=>{console.log("RESP SIGN UP UP",e.Code,e),200===e.Code?this.getUserData(f):y.emit(f.fail,{email:e.Description})})).catch((e=>{console.log("CAAAAAAAAAAAAAAAATCH",e)}))}editUser(e){fetch(this.baseUrl+v,{method:"POST",mode:"cors",credentials:"include",body:e.data}).then((e=>e.json())).then((e=>{console.log("RESP SIGN UP UP",e.Code,e),200===e.Code?this.getUserData(w):y.emit(w.fail,{error:e.Description})})).catch((e=>{console.log("CAAAAAAAAAAAAAAAATCH",e)}))}getUserData(e){console.log("GET USER DATA EVENT TYPE",e);let t=fetch(this.baseUrl+v,{method:"GET",mode:"cors",credentials:"include"}).then((e=>e.json())).then((e=>{if(console.log("RESP GET USER DATA",e.status,e),200!==e.Code)throw new Error(e.Description);this.user.name=e.User.Name,this.user.email=e.User.Email,this.user.surname=e.User.Surname,this.user.avatar=""})),s=fetch(this.baseUrl+"/getAvatar",{method:"GET",mode:"cors",credentials:"include"}).then((e=>e.blob())).then((e=>{console.log("BLOB",e),this.user.avatar=URL.createObjectURL(e)}));Promise.all([t,s]).then((t=>{console.log("УСПЕХ"),console.log("USER",this.user),y.emit(e.success,this.user)}),(t=>{y.emit(e.fail,{errors:t.message})}))}logout(){}}("http://localhost:8080");new class{constructor(e){this.baseUrl=e,this.Letters={},y.on(u,this.getLetter.bind(this)),y.on(l,this.getLetterList.bind(this)),y.on(o,this.getFolders.bind(this)),y.on(p,this.sendLetter.bind(this))}getLetter(){y.emit(c.success,{id:12,dateTime:24,sender:"sergiy",text:"HELLO WORLD",theme:"JAVA SCRIPT"})}sendLetter(e){fetch(this.baseUrl+"/sendMessage",{method:"POST",mode:"cors",credentials:"include",body:e.data}).then((e=>e.json())).then((t=>{console.log("RESP SIGN UP UP",t.Code,t),200===t.Code?(console.log("SUCCES SEND LETTER"),y.emit(d.success,B),this.Letters["исходящие"]+=[e.data]):y.emit(d.fail,{error:t.Description})})).catch((e=>{console.log("CAAAAAAAAAAAAAAAATCH",e)}))}getFolders(){y.emit(g.success,["Входящие","Отправленные"])}getLetterList(){console.log("letters",this.Letters),y.emit(m.success,[{id:12,dateTime:24,sender:"sergiy",text:"HELLO WORLD",theme:"JAVA SCRIPT"}])}}("http://localhost:8080"),new class{constructor(e,s){this.view=e,this.model=s,y.on(w.success,(e=>{console.log({path:v,data:e}),y.emit(t,{path:v,data:e})}))}}(ge,be),new class{constructor(e,s){this.signInView=e,this.model=s,y.on(f.success,(e=>{console.log({path:v,data:e}),y.emit(t,{path:B,data:e})}))}}(de,be),new class{constructor(e,s){this.view=e,this.model=s,y.on(w.success,(e=>{console.log({path:v,data:e}),y.emit(t,{path:v,data:e})}))}}(fe,be),new class{constructor(e){this.mainPageView=e,this.data={},y.on(c.success,(e=>{this.data.letter=e,this._allDataIsReady()})),y.on(m.success,(e=>{this.data.letterList=e,this._allDataIsReady()})),y.on(g.success,(e=>{this.data.folderList=e,this._allDataIsReady()})),y.on(r,(()=>{let e=!0;this.data||(console.log("WTF"),e=!1),this.data.letterList||(y.emit(l),e=!1),this.data.letter||(e=!1,y.emit(u)),this.data.folderList||(e=!1,y.emit(o)),e&&this._allDataIsReady()}))}_allDataIsReady(){this.data.letter&&this.data.folderList&&this.data.letterList&&(console.log("ALL DATA IS READY"),this.mainPageView.render(this.data))}}(we),me.register(b,ge),me.register(P,de),me.register(v,he),me.register(C,fe),me.register(B,we),me.register(V,Te),console.log(location.pathname);try{me.start(location.pathname)}catch(e){console.log("CAtch pATH",e),me.start(b)}})();